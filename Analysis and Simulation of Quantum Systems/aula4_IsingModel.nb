(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    106867,       2733]
NotebookOptionsPosition[    103387,       2621]
NotebookOutlinePosition[    103727,       2636]
CellTagsIndexPosition[    103684,       2633]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "This Mathematica code is part of the lecture script ",
 StyleBox["Introduction to Computational Quantum Mechanics",
  FontSlant->"Italic"],
 " by Roman Schmied. It is licensed under a ",
 ButtonBox["Creative Commons Attribution-ShareAlike 4.0 International License",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://creativecommons.org/licenses/by-sa/4.0/"], None},
  ButtonNote->"http://creativecommons.org/licenses/by-sa/4.0/"],
 "."
}], "Text",
 CellChangeTimes->{{3.669434091682116*^9, 3.669434147842166*^9}, {
  3.669435842013185*^9, 3.669435866952169*^9}, {3.669435915352921*^9, 
  3.669435921977655*^9}}],

Cell[BoxData[
 GraphicsBox[
  TagBox[RasterBox[CompressedData["
1:eJztWltPXFUUJuqDMSnhnYdibFIwwVBNNb60aP0BWF98qUKNPjWW0EZDgpES
qmk0EoLBagLY9E0uw22AucAMzAxzZ2Zo6StNeKhvhF+wPN8+rNN1DmcuZy6l
xa5kwZl9Wfucb6/9rbX3OW9evX75m1fq6upuvK79udz1/Uc9PV29n72m/fi4
9+bXV1/VLk5r+rmmKCSievx7qTXROr52exdp2b9EnrUV8q/7aC20RuuRIIVi
IdpMRCiWilI8HafkVoJSmSSlsildtetkJkEJrQ5t0Das9UHfgGYDtjxrHmUb
YyyszNPc8izNul00szhN0wtTSqfmJ2ly7p8ToxJnxtYb8NDqhp+C4QCFohsK
q3g6pvDbyqUp+yBDuYdZ2t7ZpgePdMV17mFO1aFNUsMbfdAXNoKRgLIJ21aM
Xe4ZA2Pge1IxNmGr+R38L5qMKl8FZsB08PYgXfrkEp2qP3VkHaAMdYM/Daq2
W9tbak7gz+F4WPny6saqCeP5lTmaXXLpGC9MF/Xh3r5eamlpOTI2ylBXKRa1
sM82wAkSW+CSyiaVTw6PDFNjY2PJnIO2w78Pq77gD/hyxMDYb3DFomeB5pd1
jAv58MjdEWpuaTbst7e3U3d3t1JccznaoK1TDGppn/uCI8EJT7FNKT/s+LTD
hF1DQwN1dnZSf38/BQIBpbhGGepkW/QNR0OUzukYw4/BFTofr9CSz23mCRsf
nrg/TvX19bq9jg7a3d0lq6AMdWiDtk4wqLV9xgKxDFwJToDfWrEFdsBxf3//
yPhSJiYmTDhjzoEx5gvzhjEQ83xBL62sLus8YePDfH/sV5g/KWzfOjaPWerz
29nf29ujWDSqFNeV2Of7xNpFPALfYl1LbNva2mznNZ9gDtBH+jFsgo8xxlOe
ED68pPnw4oyJI8B57FePdnaK4gthPyuFL+3s3793j9463WRSr8dTln2Jb0jx
QkzFMvCtxLaYz5aCMfgYMU/xhDZWIKz7sOJhr87DzBGML8caJ3OLthyTij27
1T78FXhe/OBD+urLLvruxk0D4+GhIcf2Jb7KdzX/Ai9wLMM6z2QyjrGVGDNX
wCZsI3djH/av6z4scwnJERxrrIK1zPdt5Q0Ix6RSnp3tHxwc0MToXwrL337+
xbA1Pjamys61vuPYvsQX3JjWfBc5GJeBbysV5iwocjesD+bhtcN8TXKEFV/E
cKtY8xWroE+p+LJ94HvmzBmFZXNzs2EL/Ms+/O+TJ47sS3yxL8toHIkcln1X
8gLyBHAP5g4qsbfWDR2uJRb2YdgGD2Ofd4QjtFxN5RGCg58lvhC3202tra3q
eezwfbz7uGx8EdewfnnvINcdxrPLc4Gly+WyrZP9eT3DNvZ54KHIYa7mC/pU
HgEO5jztOPgBgjiG+BaPxYyyqclJA1+n9iW+OEPY3skZv6UPcpxqampS/A68
cY21z3WcYwBvrmORHIG9dMrEwT5TnibxLRTf8vluJfGNuRY6eGtA6dtnz6rf
d0f/cGzfhK+W8+IsgX/LNVKIj0vhaun/GAO58GZisyi+Mn8qFd9y8zMWYGrN
z769dk3xs1P7zzu+uD8n+wvmxUr3F8lEUvECVObd5dh3yg+IecjZcA1MJT9Y
61jK5Qfc30nZHxeKb4ViWCnxjeddj29ZNVYp8U1iIM9fMJewD7tyD1Pu+U4t
7VvzM94XI6eyrvF8+Rkw5nJrHQT+LPOzuMjPvIH8+ZkdX76o55O8v5B7Y2se
W47k219sHO4vcFbJ+4t8ZzwvsvKzR+L2+2Mne3+rVLo/Pm5sqomvPN8Z/3vM
xEVVOd/R1gVs43wHY/EZpTxnt57vHDc21cQX2vdjn3E+eeWLKyaMnZzzwOdt
zyc12wO3B2zj4f9Fu3uuq/wpW8b5OurQRp6vn3//vOIF5NeYv+N+vudBf9Bw
wB4AGEs/ZpydvB8CtmnN1uifoxXdkxRZZm1TizEqtZsX44z+fhN87Pj95gi/
30xWjK0VO7vramBb6pjVUnCFfD8PzIq9n8d7CvV+Ht9BaH2rxQl2vlXtZ8/n
u7XyYei7750j17xL5W7IjzPG9yU58X1JTpXJ70tmF1x04eKFqt1HLXkh31i1
9l+pwOrOr3fIH/SL76MOFd9HaWWoQ5tq4mrnS4Wwr6b9Z4nvS61o7t447ns4
wVr3H44P6pc=
    "], {{0, 31}, {88, 0}}, {0, 255},
    ColorFunction->RGBColor],
   BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
   Selectable->False],
  DefaultBaseStyle->"ImageGraphics",
  ImageSize->Automatic,
  ImageSizeRaw->{88, 31},
  PlotRange->{{0, 88}, {0, 31}}]], "Text",
 CellChangeTimes->{3.669607172458665*^9}],

Cell[TextData[{
 "You can download the associated lecture script at ",
 ButtonBox["http://arxiv.org/abs/1403.7050",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://arxiv.org/abs/1403.7050"], None},
  ButtonNote->"http://arxiv.org/abs/1403.7050"]
}], "Text",
 CellChangeTimes->{{3.669434151914299*^9, 3.669434159778274*^9}, {
  3.669435746836981*^9, 3.669435760656741*^9}, {3.669435890511055*^9, 
  3.6694358923333282`*^9}}],

Cell[CellGroupData[{

Cell["transverse Ising model", "Title",
 CellChangeTimes->{{3.669356489273039*^9, 3.669356492332947*^9}, {
  3.751372029826179*^9, 
  3.751372030065608*^9}},ExpressionUUID->"e3995385-4d28-4d3c-8437-\
99f48439bfcb"],

Cell[CellGroupData[{

Cell["quantum-mechanical spin and angular momentum operators", "Subsection",
 CellChangeTimes->{{3.669352573273164*^9, 3.669352578882872*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SpinQ", "[", "S_", "]"}], ":=", 
  RowBox[{
   RowBox[{"IntegerQ", "[", 
    RowBox[{"2", "S"}], "]"}], "&&", 
   RowBox[{"S", "\[GreaterEqual]", "0"}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"splus", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", "0", "}"}], "}"}], "//", "SparseArray"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"splus", "[", 
   RowBox[{"S_", "?", "SpinQ"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"splus", "[", "S", "]"}], "=", " ", 
   RowBox[{"SparseArray", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Band", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], "]"}], "\[Rule]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"S", 
           RowBox[{"(", 
            RowBox[{"S", "+", "1"}], ")"}]}], "-", 
          RowBox[{"M", 
           RowBox[{"(", 
            RowBox[{"M", "+", "1"}], ")"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"M", ",", 
          RowBox[{"S", "-", "1"}], ",", 
          RowBox[{"-", "S"}], ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"2", "S"}], "+", "1"}], ",", 
       RowBox[{
        RowBox[{"2", "S"}], "+", "1"}]}], "}"}]}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"sminus", "[", 
   RowBox[{"S_", "?", "SpinQ"}], "]"}], ":=", 
  RowBox[{"Transpose", "[", 
   RowBox[{"splus", "[", "S", "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"sx", "[", 
   RowBox[{"S_", "?", "SpinQ"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"sx", "[", "S", "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"splus", "[", "S", "]"}], "+", 
      RowBox[{"sminus", "[", "S", "]"}]}], ")"}], "/", "2"}]}]}], "\n", 
 RowBox[{
  RowBox[{"sy", "[", 
   RowBox[{"S_", "?", "SpinQ"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"sy", "[", "S", "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"splus", "[", "S", "]"}], "-", 
      RowBox[{"sminus", "[", "S", "]"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"2", "I"}], ")"}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"sz", "[", 
   RowBox[{"S_", "?", "SpinQ"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"sz", "[", "S", "]"}], "=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Band", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "]"}], "\[Rule]", 
      RowBox[{"Range", "[", 
       RowBox[{"S", ",", 
        RowBox[{"-", "S"}], ",", 
        RowBox[{"-", "1"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"2", "S"}], "+", "1"}], ",", 
       RowBox[{
        RowBox[{"2", "S"}], "+", "1"}]}], "}"}]}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"id", "[", 
   RowBox[{"S_", "?", "SpinQ"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"id", "[", "S", "]"}], "=", 
   RowBox[{"IdentityMatrix", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"2", "S"}], "+", "1"}], ",", "SparseArray"}], 
    "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.669352559553863*^9, 3.669352619543499*^9}, {
  3.755238609624197*^9, 3.755238614902876*^9}},
 ExpressionUUID -> "e52c5a78-d091-431d-8bee-d086ee5023cc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["operators acting on many spins", "Subsection",
 CellChangeTimes->{{3.669356502774881*^9, 
  3.669356507330225*^9}},ExpressionUUID->"ba99e7d6-23b6-4f28-a6c1-\
70676c452132"],

Cell[TextData[{
 "an operator ",
 Cell[BoxData[
  FormBox["a", TraditionalForm]],ExpressionUUID->
  "0beb2448-f210-4c48-960c-8ef5308a5e47"],
 " acting on spin ",
 Cell[BoxData[
  FormBox["k", TraditionalForm]],ExpressionUUID->
  "f85ffc19-0abc-46ca-8427-e2c8659c4c5a"],
 " out of a set of ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "e7313b9b-efe9-4305-b490-aa2d7b83e82e"],
 " spins-",
 Cell[BoxData[
  FormBox["S", TraditionalForm]],ExpressionUUID->
  "b45551d4-3600-4dda-a394-7a97b4ba7e42"],
 ":"
}], "Text",
 CellChangeTimes->{{3.669356518062566*^9, 
  3.6693565389094057`*^9}},ExpressionUUID->"189c6e6e-12f5-4e3e-8b06-\
a4b9b6e612f6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"op", "[", 
    RowBox[{
     RowBox[{"S_", "?", "SpinQ"}], ",", "n_Integer", ",", "k_Integer", ",", 
     RowBox[{"a_", "?", "MatrixQ"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"1", "\[LessEqual]", "k", "\[LessEqual]", "n"}], "&&", 
    RowBox[{
     RowBox[{"Dimensions", "[", "a", "]"}], "\[Equal]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"2", "S"}], "+", "1"}], ",", 
       RowBox[{
        RowBox[{"2", "S"}], "+", "1"}]}], "}"}]}]}]}], ":=", 
  RowBox[{"KroneckerProduct", "[", 
   RowBox[{
    RowBox[{"IdentityMatrix", "[", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", "S"}], "+", "1"}], ")"}], 
       RowBox[{"k", "-", "1"}]], ",", "SparseArray"}], "]"}], ",", "a", ",", 
    RowBox[{"IdentityMatrix", "[", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", "S"}], "+", "1"}], ")"}], 
       RowBox[{"n", "-", "k"}]], ",", "SparseArray"}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.669356515340596*^9, 3.669356515341918*^9}, {
  3.6693571117238398`*^9, 3.669357154610497*^9}, {3.755241852451318*^9, 
  3.75524188966756*^9}},
 ExpressionUUID -> "1c26883e-9727-4530-b384-a52cfa676085"],

Cell[TextData[{
 "spin operators acting on spin ",
 Cell[BoxData[
  FormBox["k", TraditionalForm]],ExpressionUUID->
  "47273c04-dbe2-444f-9d76-24c470a2db14"],
 " out of a set of ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "b71cc81a-d8e0-491e-b82c-0e59a3f39953"],
 " spins-",
 Cell[BoxData[
  FormBox["S", TraditionalForm]],ExpressionUUID->
  "53211c1b-00ba-4431-8791-6bd60100262f"],
 ":"
}], "Text",
 CellChangeTimes->{{3.669356518062566*^9, 3.6693565389094057`*^9}, {
  3.669357160605501*^9, 
  3.669357163868093*^9}},ExpressionUUID->"bce99a03-040d-4301-86cd-\
6d30ff7ee126"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sx", "[", 
    RowBox[{
     RowBox[{"S_", "?", "SpinQ"}], ",", "n_Integer", ",", "k_Integer"}], 
    "]"}], "/;", 
   RowBox[{"1", "\[LessEqual]", "k", "\[LessEqual]", "n"}]}], ":=", 
  RowBox[{"op", "[", 
   RowBox[{"S", ",", "n", ",", "k", ",", 
    RowBox[{"sx", "[", "S", "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"sy", "[", 
    RowBox[{
     RowBox[{"S_", "?", "SpinQ"}], ",", "n_Integer", ",", "k_Integer"}], 
    "]"}], "/;", 
   RowBox[{"1", "\[LessEqual]", "k", "\[LessEqual]", "n"}]}], ":=", 
  RowBox[{"op", "[", 
   RowBox[{"S", ",", "n", ",", "k", ",", 
    RowBox[{"sy", "[", "S", "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"sz", "[", 
    RowBox[{
     RowBox[{"S_", "?", "SpinQ"}], ",", "n_Integer", ",", "k_Integer"}], 
    "]"}], "/;", 
   RowBox[{"1", "\[LessEqual]", "k", "\[LessEqual]", "n"}]}], ":=", 
  RowBox[{"op", "[", 
   RowBox[{"S", ",", "n", ",", "k", ",", 
    RowBox[{"sz", "[", "S", "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.669356515340596*^9, 3.669356515341918*^9}, {
  3.6693571117238398`*^9, 3.669357154610497*^9}},
 ExpressionUUID -> "77338114-cefb-47b3-8e6a-ac66df07daf7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Hamiltonian", "Subsection",
 CellChangeTimes->{{3.669357180362071*^9, 
  3.669357181564768*^9}},ExpressionUUID->"a03fff3b-25fa-4514-9c08-\
51145f0e9387"],

Cell[TextData[{
 "transverse Ising model on a ring of ",
 Cell[BoxData[
  FormBox["N", TraditionalForm]],ExpressionUUID->
  "cbffc3fa-d1bb-44cf-b9cb-4677385c927a"],
 " spins:"
}], "Text",
 CellChangeTimes->{{3.7154073356990623`*^9, 
  3.715407352456781*^9}},ExpressionUUID->"5f2d9558-e4c6-46e3-bb9f-\
087344fc0f38"],

Cell[BoxData[
 FormBox[
  RowBox[{
   OverscriptBox["H", "^"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "b"}], 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"k", "=", "1"}], "N"], 
      SubsuperscriptBox[
       OverscriptBox["S", "^"], "x", 
       RowBox[{"(", "k", ")"}]]}]}], "+", 
    RowBox[{"J", 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"k", "=", "1"}], 
       RowBox[{"N", "-", "1"}]], 
      RowBox[{
       SubsuperscriptBox[
        OverscriptBox["S", "^"], "z", 
        RowBox[{"(", "k", ")"}]], 
       SubsuperscriptBox[
        OverscriptBox["S", "^"], "z", 
        RowBox[{"(", 
         RowBox[{"k", "+", "1"}], ")"}]]}]}]}]}]}], 
  TraditionalForm]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.669357187411963*^9, 3.669357262712125*^9}, {
   3.715407318056921*^9, 3.715407323411457*^9}, 3.7154073619979153`*^9, {
   3.784292869811988*^9, 3.784292870283626*^9}, {3.784293273821115*^9, 
   3.784293276095987*^9}},
 ExpressionUUID -> "0601ac50-0f53-494e-8d7a-a6f05759b43f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"H", "[", 
   RowBox[{
    RowBox[{"S_", "?", "SpinQ"}], ",", 
    RowBox[{"n_Integer", "/;", 
     RowBox[{"n", "\[GreaterEqual]", "3"}]}], ",", "b_", ",", "J_Real"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "b"}], " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"sx", "[", 
       RowBox[{"S", ",", "n", ",", "k"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "n"}], "}"}]}], "]"}]}], "+", 
   RowBox[{"J", " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"sz", "[", 
        RowBox[{"S", ",", "n", ",", "k"}], "]"}], ".", 
       RowBox[{"sz", "[", 
        RowBox[{"S", ",", "n", ",", 
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{"k", "+", "1"}], ",", "n", ",", "1"}], "]"}]}], "]"}]}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "n"}], "}"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.669357182757553*^9, 3.669357182758881*^9}, {
  3.669357269463717*^9, 3.6693572775963507`*^9}, {3.78429287686362*^9, 
  3.784292878376251*^9}, {3.7842929123836565`*^9, 3.784292965139639*^9}, {
  3.7842930682150774`*^9, 3.784293088750145*^9}, {3.78429312648133*^9, 
  3.7842931333946*^9}, {3.784293434291395*^9, 3.7842934366365056`*^9}, {
  3.784293509378458*^9, 3.78429352225201*^9}},
 ExpressionUUID -> "7c14527e-3728-4c0f-891f-9e494e4ce0e9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["asymptotic ground states", "Subsection",
 CellChangeTimes->{{3.669357329988249*^9, 3.669357334205896*^9}},
 ExpressionUUID -> "7f11a72b-d9c9-456f-b629-6d1a3a4417a8"],

Cell[TextData[{
 "product state ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    TemplateBox[{"\[Theta]"},
     "Ket"], 
    RowBox[{"\[CircleTimes]", "N"}]], TraditionalForm]],ExpressionUUID->
  "0e6abc8b-805c-4380-b503-642b47d858fe"],
 ":"
}], "Text",
 CellChangeTimes->{{3.669357350687016*^9, 
  3.669357394291416*^9}},ExpressionUUID->"18175f2b-14fa-4955-8428-\
53357062f989"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"productstate", "[", 
    RowBox[{
     RowBox[{"\[Theta]_", "?", "VectorQ"}], ",", "1"}], "]"}], "=", 
   "\[Theta]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"productstate", "[", 
   RowBox[{
    RowBox[{"\[Theta]_", "?", "VectorQ"}], ",", 
    RowBox[{"n_Integer", "/;", 
     RowBox[{"n", "\[GreaterEqual]", "2"}]}]}], "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"KroneckerProduct", "@@", 
    RowBox[{"Table", "[", 
     RowBox[{"\[Theta]", ",", 
      RowBox[{"{", "n", "}"}]}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6693573489797573`*^9, 3.669357374011478*^9}, {
   3.732441020251861*^9, 3.73244103469547*^9}, 3.732441177925366*^9, {
   3.783605114050127*^9, 3.783605118176517*^9}},
 ExpressionUUID -> "feab65ac-ec12-4d7e-baaf-47c4e44ed78a"],

Cell["parallel-spin states:", "Text",
 CellChangeTimes->{{3.669357433216735*^9, 
  3.669357436040885*^9}},ExpressionUUID->"f3b08667-856d-48e2-8370-\
928c1ca1d3d0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xup", "[", 
   RowBox[{"S_", "?", "SpinQ"}], "]"}], ":=", 
  RowBox[{
   SuperscriptBox["2", 
    RowBox[{"-", "S"}]], 
   RowBox[{"Table", "[", 
    RowBox[{
     SqrtBox[
      RowBox[{"Binomial", "[", 
       RowBox[{
        RowBox[{"2", "S"}], ",", 
        RowBox[{"M", "+", "S"}]}], "]"}]], ",", 
     RowBox[{"{", 
      RowBox[{"M", ",", "S", ",", 
       RowBox[{"-", "S"}], ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"xdn", "[", 
   RowBox[{"S_", "?", "SpinQ"}], "]"}], ":=", 
  RowBox[{
   SuperscriptBox["2", 
    RowBox[{"-", "S"}]], 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"M", "+", "S"}]], 
      SqrtBox[
       RowBox[{"Binomial", "[", 
        RowBox[{
         RowBox[{"2", "S"}], ",", 
         RowBox[{"M", "+", "S"}]}], "]"}]]}], ",", 
     RowBox[{"{", 
      RowBox[{"M", ",", "S", ",", 
       RowBox[{"-", "S"}], ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"zup", "[", 
   RowBox[{"S_", "?", "SpinQ"}], "]"}], ":=", 
  RowBox[{"SparseArray", "[", 
   RowBox[{
    RowBox[{"1", "\[Rule]", "1"}], ",", 
    RowBox[{
     RowBox[{"2", "S"}], "+", "1"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"zdn", "[", 
   RowBox[{"S_", "?", "SpinQ"}], "]"}], ":=", 
  RowBox[{"SparseArray", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "1"}], "\[Rule]", "1"}], ",", 
    RowBox[{
     RowBox[{"2", "S"}], "+", "1"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.669357451142497*^9, 3.669357497240774*^9}},
 ExpressionUUID -> "60d608de-f045-4f20-879d-a7b5712b9f55"],

Cell["product states:", "Text",
 CellChangeTimes->{{3.6693702828500643`*^9, 
  3.6693702852470093`*^9}},ExpressionUUID->"8ffa52a6-3ed8-41e4-b4e2-\
20c918d98683"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"allxup", "[", 
   RowBox[{
    RowBox[{"S_", "?", "SpinQ"}], ",", 
    RowBox[{"n_Integer", "/;", 
     RowBox[{"n", "\[GreaterEqual]", "1"}]}]}], "]"}], ":=", 
  RowBox[{"productstate", "[", 
   RowBox[{
    RowBox[{"xup", "[", "S", "]"}], ",", "n"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"allxdn", "[", 
   RowBox[{
    RowBox[{"S_", "?", "SpinQ"}], ",", 
    RowBox[{"n_Integer", "/;", 
     RowBox[{"n", "\[GreaterEqual]", "1"}]}]}], "]"}], ":=", 
  RowBox[{"productstate", "[", 
   RowBox[{
    RowBox[{"xdn", "[", "S", "]"}], ",", "n"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"allzup", "[", 
   RowBox[{
    RowBox[{"S_", "?", "SpinQ"}], ",", 
    RowBox[{"n_Integer", "/;", 
     RowBox[{"n", "\[GreaterEqual]", "1"}]}]}], "]"}], ":=", 
  RowBox[{"productstate", "[", 
   RowBox[{
    RowBox[{"zup", "[", "S", "]"}], ",", "n"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"allzdn", "[", 
   RowBox[{
    RowBox[{"S_", "?", "SpinQ"}], ",", 
    RowBox[{"n_Integer", "/;", 
     RowBox[{"n", "\[GreaterEqual]", "1"}]}]}], "]"}], ":=", 
  RowBox[{"productstate", "[", 
   RowBox[{
    RowBox[{"zdn", "[", "S", "]"}], ",", "n"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.669357451142497*^9, 3.669357497240774*^9}, {
  3.669370290512122*^9, 3.669370338171356*^9}},
 ExpressionUUID -> "a810b35a-8886-47f2-9fc3-db864e36666e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Hamiltonian diagonalization", "Subsection",
 CellChangeTimes->{{3.669357511484273*^9, 
  3.669357515612252*^9}},ExpressionUUID->"9915b2d7-d0e0-4004-b18c-\
f0db3cd3c954"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"S", "=", 
    RowBox[{"1", "/", "2"}]}], ";", 
   RowBox[{"n", "=", "14"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "Hamiltonian", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"h", "[", 
     RowBox[{"b_", ",", "J_"}], "]"}], "=", 
    RowBox[{"H", "[", 
     RowBox[{"S", ",", "n", ",", "b", ",", " ", "J"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "two", " ", "degenerate", " ", "ground", " ", "states", " ", "for", " ", 
     "b"}], "=", "0"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gs0up", "=", 
   RowBox[{"allzup", "[", 
    RowBox[{"S", ",", "n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gs0dn", "=", 
    RowBox[{"allzdn", "[", 
     RowBox[{"S", ",", "n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"ground", " ", "state", " ", "for", " ", "b"}], "=", 
    RowBox[{"+", "\[Infinity]"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gsplusinf", "=", 
    RowBox[{"allxup", "[", 
     RowBox[{"S", ",", "n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"ground", " ", "state", " ", "for", " ", "b"}], "=", 
    RowBox[{"-", "\[Infinity]"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gsminusinf", "=", 
    RowBox[{"allxdn", "[", 
     RowBox[{"S", ",", "n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "numerically", " ", "calculate", " ", "lowest", " ", "m", " ", 
    "eigenstates"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "gs", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gs", "[", 
     RowBox[{
      RowBox[{"b_", "?", "NumericQ"}], ",", 
      RowBox[{"m_Integer", "/;", 
       RowBox[{"m", "\[GreaterEqual]", "1"}]}], ",", " ", "J_Real"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"gs", "[", 
      RowBox[{"b", ",", "m", ",", " ", "J"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Eigensystem", "[", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"h", "[", 
             RowBox[{
              RowBox[{"N", "[", "b", "]"}], ",", "J"}], "]"}]}], ",", "m", 
           ",", 
           RowBox[{"Method", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<Arnoldi\>\"", ",", 
              RowBox[{"\"\<Criteria\>\"", "\[Rule]", "\"\<RealPart\>\""}], 
              ",", 
              RowBox[{"MaxIterations", "\[Rule]", 
               SuperscriptBox["10", "6"]}]}], "}"}]}]}], "]"}]}], "//", 
        "Transpose"}], "//", "Sort"}], "//", "Transpose"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"spin", " ", "components", " ", "expectation", " ", "values"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"mx", ",", "my", ",", "mz"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mx", "[", 
    RowBox[{
     RowBox[{"b_", "?", "NumericQ"}], ",", 
     RowBox[{"m_Integer", "/;", 
      RowBox[{"m", "\[GreaterEqual]", "1"}]}], ",", "k_Integer", ",", " ", 
     "J_Real"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"mx", "[", 
     RowBox[{"b", ",", "m", ",", "k", ",", "J"}], "]"}], "=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"g", "=", 
        RowBox[{
         RowBox[{"gs", "[", 
          RowBox[{"b", ",", "m", ",", " ", "J"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"Re", "[", 
       RowBox[{
        RowBox[{"Conjugate", "[", "g", "]"}], ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"sx", "[", 
           RowBox[{"S", ",", "n", ",", 
            RowBox[{"Mod", "[", 
             RowBox[{"k", ",", "n", ",", "1"}], "]"}]}], "]"}], ".", "g"}], 
         ")"}]}], "]"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"my", "[", 
    RowBox[{
     RowBox[{"b_", "?", "NumericQ"}], ",", 
     RowBox[{"m_Integer", "/;", 
      RowBox[{"m", "\[GreaterEqual]", "1"}]}], ",", "k_Integer", ",", " ", 
     "J_Real"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"my", "[", 
     RowBox[{"b", ",", "m", ",", "k", ",", " ", "J"}], "]"}], "=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"g", "=", 
        RowBox[{
         RowBox[{"gs", "[", 
          RowBox[{"b", ",", "m", ",", "J"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"Re", "[", 
       RowBox[{
        RowBox[{"Conjugate", "[", "g", "]"}], ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"sy", "[", 
           RowBox[{"S", ",", "n", ",", 
            RowBox[{"Mod", "[", 
             RowBox[{"k", ",", "n", ",", "1"}], "]"}]}], "]"}], ".", "g"}], 
         ")"}]}], "]"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"mz", "[", 
     RowBox[{
      RowBox[{"b_", "?", "NumericQ"}], ",", 
      RowBox[{"m_Integer", "/;", 
       RowBox[{"m", "\[GreaterEqual]", "1"}]}], ",", "k_Integer", ",", " ", 
      "J_Real"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"mz", "[", 
      RowBox[{"b", ",", "m", ",", "k", ",", "J"}], "]"}], "=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"g", "=", 
         RowBox[{
          RowBox[{"gs", "[", 
           RowBox[{"b", ",", "m", ",", " ", "J"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Re", "[", 
        RowBox[{
         RowBox[{"Conjugate", "[", "g", "]"}], ".", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"sz", "[", 
            RowBox[{"S", ",", "n", ",", 
             RowBox[{"Mod", "[", 
              RowBox[{"k", ",", "n", ",", "1"}], "]"}]}], "]"}], ".", "g"}], 
          ")"}]}], "]"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"spin", "-", 
    RowBox[{"spin", " ", "correlation", " ", "operator"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "Cop", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Cop", "[", 
     RowBox[{"k1_Integer", ",", "k2_Integer"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Cop", "[", 
      RowBox[{"k1", ",", "k2"}], "]"}], "=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{"Mod", "[", 
           RowBox[{"k1", ",", "n", ",", "1"}], "]"}]}], ",", 
         RowBox[{"q2", "=", 
          RowBox[{"Mod", "[", 
           RowBox[{"k2", ",", "n", ",", "1"}], "]"}]}]}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"sx", "[", 
          RowBox[{"S", ",", "n", ",", "q1"}], "]"}], ".", 
         RowBox[{"sx", "[", 
          RowBox[{"S", ",", "n", ",", "q2"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"sy", "[", 
          RowBox[{"S", ",", "n", ",", "q1"}], "]"}], ".", 
         RowBox[{"sy", "[", 
          RowBox[{"S", ",", "n", ",", "q2"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"sz", "[", 
          RowBox[{"S", ",", "n", ",", "q1"}], "]"}], ".", 
         RowBox[{"sz", "[", 
          RowBox[{"S", ",", "n", ",", "q2"}], "]"}]}]}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"spin", "-", 
    RowBox[{"spin", " ", "correlations"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "c", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"c", "[", 
    RowBox[{
     RowBox[{"b_", "?", "NumericQ"}], ",", 
     RowBox[{"m_Integer", "/;", 
      RowBox[{"m", "\[GreaterEqual]", "1"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k1_Integer", ",", "k2_Integer"}], "}"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"b", ",", "m", ",", 
      RowBox[{"{", 
       RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}], "=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"g", "=", 
        RowBox[{
         RowBox[{"gs", "[", 
          RowBox[{"b", ",", "m"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"Re", "[", 
        RowBox[{
         RowBox[{"Conjugate", "[", "g", "]"}], ".", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cop", "[", 
            RowBox[{"k1", ",", "k2"}], "]"}], ".", "g"}], ")"}]}], "]"}], "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"mx", "[", 
           RowBox[{"b", ",", "m", ",", "k1"}], "]"}], "*", 
          RowBox[{"mx", "[", 
           RowBox[{"b", ",", "m", ",", "k2"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"my", "[", 
           RowBox[{"b", ",", "m", ",", "k1"}], "]"}], "*", 
          RowBox[{"my", "[", 
           RowBox[{"b", ",", "m", ",", "k2"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"mz", "[", 
           RowBox[{"b", ",", "m", ",", "k1"}], "]"}], "*", 
          RowBox[{"mz", "[", 
           RowBox[{"b", ",", "m", ",", "k2"}], "]"}]}]}], ")"}]}]}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.669357526092495*^9, 3.669357624727427*^9}, {
   3.669357750334659*^9, 3.6693577525466948`*^9}, {3.669357792495229*^9, 
   3.669357812051929*^9}, {3.66935788286034*^9, 3.6693579541963997`*^9}, 
   3.6693583717979107`*^9, {3.669359000314495*^9, 3.669359001012247*^9}, {
   3.669370347720378*^9, 3.669370367441985*^9}, {3.669370822452207*^9, 
   3.669370835985721*^9}, {3.6823113183316927`*^9, 3.682311318982613*^9}, {
   3.699873026311153*^9, 3.699873026403059*^9}, 3.699873450070044*^9, 
   3.6998741875325603`*^9, 3.699881839370494*^9, {3.69988397708251*^9, 
   3.699883977236745*^9}, {3.699884038294417*^9, 3.6998840384604673`*^9}, {
   3.73242992117663*^9, 3.732429921446113*^9}, {3.732429972593904*^9, 
   3.732429972686389*^9}, {3.73243087392775*^9, 3.732430882078703*^9}, {
   3.751382133832872*^9, 3.7513821340224752`*^9}, {3.751386240553341*^9, 
   3.751386395056203*^9}, {3.75138728417175*^9, 3.751387287570953*^9}, {
   3.7513906074655323`*^9, 3.751390637928794*^9}, {3.751390727337159*^9, 
   3.751390730400978*^9}, {3.751391388771875*^9, 3.751391396124897*^9}, {
   3.751391995306478*^9, 3.751392214429585*^9}, {3.751392249401331*^9, 
   3.751392256424999*^9}, {3.751392861088583*^9, 3.7513931422584753`*^9}, {
   3.751393836195292*^9, 3.751393858499131*^9}, {3.784293154423428*^9, 
   3.784293165878807*^9}, {3.784293205537592*^9, 3.784293256506353*^9}, {
   3.7842935329369183`*^9, 3.7842935808154354`*^9}, {3.7842936548366046`*^9, 
   3.7842936658105965`*^9}, {3.784293712597842*^9, 3.7842937138115196`*^9}, {
   3.784294050864888*^9, 3.7842940513156457`*^9}, {3.7842943745087395`*^9, 
   3.7842943929474163`*^9}, {3.7842945969428515`*^9, 3.784294602484565*^9}, {
   3.78429628723077*^9, 3.7842962878361907`*^9}},
 ExpressionUUID -> "90212385-7136-41f4-a2cc-84585ccd2af1"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"S", "=", 
       RowBox[{"1", "/", "2"}]}], ",", 
      RowBox[{"n", "=", "3"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", "Hamiltonian", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"h", "[", 
       RowBox[{"b_", ",", "J_"}], "]"}], "=", 
      RowBox[{"H", "[", 
       RowBox[{"S", ",", "n", ",", "b", ",", " ", "J"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "two", " ", "degenerate", " ", "ground", " ", "states", " ", "for", 
        " ", "b"}], "=", "0"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"gs0up", "=", 
      RowBox[{"allzup", "[", 
       RowBox[{"S", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gs0dn", "=", 
      RowBox[{"allzdn", "[", 
       RowBox[{"S", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"ground", " ", "state", " ", "for", " ", "b"}], "=", 
       RowBox[{"+", "\[Infinity]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"gsplusinf", "=", 
      RowBox[{"allxup", "[", 
       RowBox[{"S", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"ground", " ", "state", " ", "for", " ", "b"}], "=", 
       RowBox[{"-", "\[Infinity]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"gsminusinf", "=", 
      RowBox[{"allxdn", "[", 
       RowBox[{"S", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "numerically", " ", "calculate", " ", "lowest", " ", "m", " ", 
       "eigenstates"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", "gs", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gs", "[", 
       RowBox[{
        RowBox[{"b_", "?", "NumericQ"}], ",", 
        RowBox[{"m_Integer", "/;", 
         RowBox[{"m", "\[GreaterEqual]", "1"}]}], ",", " ", "J_Real"}], "]"}],
       ":=", 
      RowBox[{
       RowBox[{"gs", "[", 
        RowBox[{"b", ",", "m", ",", " ", "J"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Eigensystem", "[", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"h", "[", 
               RowBox[{"N", "[", 
                RowBox[{"b", ",", "J"}], "]"}], "]"}]}], ",", "m", ",", 
             RowBox[{"Method", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"\"\<Arnoldi\>\"", ",", 
                RowBox[{"\"\<Criteria\>\"", "\[Rule]", "\"\<RealPart\>\""}], 
                ",", 
                RowBox[{"MaxIterations", "\[Rule]", 
                 SuperscriptBox["10", "6"]}]}], "}"}]}]}], "]"}]}], "//", 
          "Transpose"}], "//", "Sort"}], "//", "Transpose"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"spin", " ", "components", " ", "expectation", " ", "values"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", 
      RowBox[{"mx", ",", "my", ",", "mz"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mx", "[", 
       RowBox[{
        RowBox[{"b_", "?", "NumericQ"}], ",", 
        RowBox[{"m_Integer", "/;", 
         RowBox[{"m", "\[GreaterEqual]", "1"}]}], ",", "k_Integer", ",", " ", 
        "J_Real"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"mx", "[", 
        RowBox[{"b", ",", "m", ",", "k", ",", "J"}], "]"}], "=", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"g", "=", 
           RowBox[{
            RowBox[{"gs", "[", 
             RowBox[{"b", ",", "m", ",", " ", "J"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"Re", "[", 
          RowBox[{
           RowBox[{"Conjugate", "[", "g", "]"}], ".", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"sx", "[", 
              RowBox[{"S", ",", "n", ",", 
               RowBox[{"Mod", "[", 
                RowBox[{"k", ",", "n", ",", "1"}], "]"}]}], "]"}], ".", "g"}],
             ")"}]}], "]"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"my", "[", 
       RowBox[{
        RowBox[{"b_", "?", "NumericQ"}], ",", 
        RowBox[{"m_Integer", "/;", 
         RowBox[{"m", "\[GreaterEqual]", "1"}]}], ",", "k_Integer", ",", " ", 
        "J_Real"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"my", "[", 
        RowBox[{"b", ",", "m", ",", "k", ",", " ", "J"}], "]"}], "=", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"g", "=", 
           RowBox[{
            RowBox[{"gs", "[", 
             RowBox[{"b", ",", "m", ",", "J"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"Re", "[", 
          RowBox[{
           RowBox[{"Conjugate", "[", "g", "]"}], ".", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"sy", "[", 
              RowBox[{"S", ",", "n", ",", 
               RowBox[{"Mod", "[", 
                RowBox[{"k", ",", "n", ",", "1"}], "]"}]}], "]"}], ".", "g"}],
             ")"}]}], "]"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mz", "[", 
       RowBox[{
        RowBox[{"b_", "?", "NumericQ"}], ",", 
        RowBox[{"m_Integer", "/;", 
         RowBox[{"m", "\[GreaterEqual]", "1"}]}], ",", "k_Integer", ",", " ", 
        "J_Real"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"mz", "[", 
        RowBox[{"b", ",", "m", ",", "k", ",", "J"}], "]"}], "=", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"g", "=", 
           RowBox[{
            RowBox[{"gs", "[", 
             RowBox[{"b", ",", "m", ",", " ", "J"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"Re", "[", 
          RowBox[{
           RowBox[{"Conjugate", "[", "g", "]"}], ".", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"sz", "[", 
              RowBox[{"S", ",", "n", ",", 
               RowBox[{"Mod", "[", 
                RowBox[{"k", ",", "n", ",", "1"}], "]"}]}], "]"}], ".", "g"}],
             ")"}]}], "]"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"spin", "-", 
       RowBox[{"spin", " ", "correlation", " ", "operator"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", "Cop", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Cop", "[", 
       RowBox[{"k1_Integer", ",", "k2_Integer"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"Cop", "[", 
        RowBox[{"k1", ",", "k2"}], "]"}], "=", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"q1", "=", 
            RowBox[{"Mod", "[", 
             RowBox[{"k1", ",", "n", ",", "1"}], "]"}]}], ",", 
           RowBox[{"q2", "=", 
            RowBox[{"Mod", "[", 
             RowBox[{"k2", ",", "n", ",", "1"}], "]"}]}]}], "}"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"sx", "[", 
            RowBox[{"S", ",", "n", ",", "q1"}], "]"}], ".", 
           RowBox[{"sx", "[", 
            RowBox[{"S", ",", "n", ",", "q2"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"sy", "[", 
            RowBox[{"S", ",", "n", ",", "q1"}], "]"}], ".", 
           RowBox[{"sy", "[", 
            RowBox[{"S", ",", "n", ",", "q2"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"sz", "[", 
            RowBox[{"S", ",", "n", ",", "q1"}], "]"}], ".", 
           RowBox[{"sz", "[", 
            RowBox[{"S", ",", "n", ",", "q2"}], "]"}]}]}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"spin", "-", 
       RowBox[{"spin", " ", "correlations"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", "c", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{
        RowBox[{"b_", "?", "NumericQ"}], ",", 
        RowBox[{"m_Integer", "/;", 
         RowBox[{"m", "\[GreaterEqual]", "1"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"k1_Integer", ",", "k2_Integer"}], "}"}]}], "]"}], ":=", 
      RowBox[{
       RowBox[{"c", "[", 
        RowBox[{"b", ",", "m", ",", 
         RowBox[{"{", 
          RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}], "=", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"g", "=", 
           RowBox[{
            RowBox[{"gs", "[", 
             RowBox[{"b", ",", "m"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{
          RowBox[{"Re", "[", 
           RowBox[{
            RowBox[{"Conjugate", "[", "g", "]"}], ".", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cop", "[", 
               RowBox[{"k1", ",", "k2"}], "]"}], ".", "g"}], ")"}]}], "]"}], 
          "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"mx", "[", 
              RowBox[{"b", ",", "m", ",", "k1"}], "]"}], "*", 
             RowBox[{"mx", "[", 
              RowBox[{"b", ",", "m", ",", "k2"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"my", "[", 
              RowBox[{"b", ",", "m", ",", "k1"}], "]"}], "*", 
             RowBox[{"my", "[", 
              RowBox[{"b", ",", "m", ",", "k2"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"mz", "[", 
              RowBox[{"b", ",", "m", ",", "k1"}], "]"}], "*", 
             RowBox[{"mz", "[", 
              RowBox[{"b", ",", "m", ",", "k2"}], "]"}]}]}], ")"}]}]}], 
        "]"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.669357526092495*^9, 3.669357624727427*^9}, {
   3.669357750334659*^9, 3.6693577525466948`*^9}, {3.669357792495229*^9, 
   3.669357812051929*^9}, {3.66935788286034*^9, 3.6693579541963997`*^9}, 
   3.6693583717979107`*^9, {3.669359000314495*^9, 3.669359001012247*^9}, {
   3.669370347720378*^9, 3.669370367441985*^9}, {3.669370822452207*^9, 
   3.669370835985721*^9}, {3.6823113183316927`*^9, 3.682311318982613*^9}, {
   3.699873026311153*^9, 3.699873026403059*^9}, 3.699873450070044*^9, 
   3.6998741875325603`*^9, 3.699881839370494*^9, {3.69988397708251*^9, 
   3.699883977236745*^9}, {3.699884038294417*^9, 3.6998840384604673`*^9}, {
   3.73242992117663*^9, 3.732429921446113*^9}, {3.732429972593904*^9, 
   3.732429972686389*^9}, {3.73243087392775*^9, 3.732430882078703*^9}, {
   3.751382133832872*^9, 3.7513821340224752`*^9}, {3.751386240553341*^9, 
   3.751386395056203*^9}, {3.75138728417175*^9, 3.751387287570953*^9}, {
   3.7513906074655323`*^9, 3.751390637928794*^9}, {3.751390727337159*^9, 
   3.751390730400978*^9}, {3.751391388771875*^9, 3.751391396124897*^9}, {
   3.751391995306478*^9, 3.751392214429585*^9}, {3.751392249401331*^9, 
   3.751392256424999*^9}, {3.751392861088583*^9, 3.7513931422584753`*^9}, {
   3.751393836195292*^9, 3.751393858499131*^9}, {3.784293154423428*^9, 
   3.784293165878807*^9}, {3.784293205537592*^9, 3.784293256506353*^9}, {
   3.7842935329369183`*^9, 3.7842935808154354`*^9}, {3.7842936548366046`*^9, 
   3.7842936658105965`*^9}, {3.784293712597842*^9, 3.7842937138115196`*^9}, {
   3.784294050864888*^9, 3.7842940513156457`*^9}, 3.78429436982622*^9},
 ExpressionUUID -> "90212385-7136-41f4-a2cc-84585ccd2af1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["analysis of the ground state", "Subsection",
 CellChangeTimes->{{3.6693576377093077`*^9, 3.669357641792307*^9}},
 ExpressionUUID -> "4151269e-8902-4d8b-af6d-5e5465b58c17"],

Cell[CellGroupData[{

Cell["energy gap", "Subsubsection",
 CellChangeTimes->{{3.669357672696426*^9, 3.669357673821207*^9}},
 ExpressionUUID -> "25f316e9-43cf-4169-b340-65d678a6095d"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"bmax", "=", "3."}], ",", 
     RowBox[{"db", "=", 
      RowBox[{"1", "/", "8"}]}], ",", 
     RowBox[{"m", "=", "2"}], ",", 
     RowBox[{"J", "=", "1."}]}], "}"}], ",", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"b", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"gs", "[", 
           RowBox[{"b", ",", "m", ",", "J"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}], "-", 
         RowBox[{
          RowBox[{"gs", "[", 
           RowBox[{"b", ",", "m", ",", "J"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"b", ",", 
        RowBox[{"-", "bmax"}], ",", "bmax", ",", "db"}], "}"}]}], "]"}], 
    "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.669357651200181*^9, 3.66935765502314*^9}, {
   3.669358483284834*^9, 3.669358483495091*^9}, {3.6693590142730703`*^9, 
   3.669359014767654*^9}, 3.6693591967511063`*^9, {3.7842936906798067`*^9, 
   3.7842937071786213`*^9}, {3.784294020237747*^9, 3.784294033099338*^9}},
 ExpressionUUID -> "b984659b-62bf-4921-bc19-82e0cc1a5db2"],

Cell[BoxData[
 SubscriptBox[
  SubscriptBox[
   GraphicsBox[{{}, {{}, {}, 
      {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       0.019444444444444445`], AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJxVkj9IQkEcx3/vj/kGBRtqarC0qYaitbpbmiqyEionC4JoyQhCaHF0KiGC
BiGXoC3cWuIOoj80vWh544OEJIQeJiIi1j39EXcHd18+HHe/f9/RnYO1XR0A
psX2tb8sbs34atI+B3lpy1cDeYB7V77qyAF+N6YJ1ZBNnoz3fkM2eDRpCe2S
Puvcfo4I7SBr3JmMCW0jA68OLQtpIXdZ5rostIncYc52WQRsILdZPrdnAtSR
WyxdTIcAPOQmiz5+LgLUkBvMfl/SNagi11n07OvDgAqyxyIX+8eD4CLXWOnw
NH4PDnKVud+3I+GAjVxhbjhx/priyC6D340ThxeRHQZ0dbz1sIJsM4CMiPA2
j+Uy/7xc+JkDZbmzeN97l/q/9+NmpfciLzch/S/yDm5K8SskGpLzqxKq5F8j
mSO5Po/YSv114in9aZCC0r8mmXqS+9siltL/NlHn0yFpZX5dUlDmCzQxLM9f
o5kJ2R86zSr+MWhuXfaXSXOK/wI0HZP9OUBvFP8GaV7xt0Vf0P9/mauxQQ==

        "]]}}, {}},
    AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
    Axes->{True, True},
    AxesLabel->{None, None},
    AxesOrigin->{0, 0},
    DisplayFunction->Identity,
    Frame->{{False, False}, {False, False}},
    FrameLabel->{{None, None}, {None, None}},
    FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
    GridLines->{None, None},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    Method->{},
    PlotRange->{{-3., 3.}, {0, 2.500000000005887}},
    PlotRangeClipping->True,
    PlotRangePadding->{{
       Scaled[0.02], 
       Scaled[0.02]}, {
       Scaled[0.02], 
       Scaled[0.05]}},
    Ticks->{Automatic, Automatic}], "\[Placeholder]"], 
  SubscriptBox["", "\[Placeholder]"]]], "Input",
 CellChangeTimes->{{3.7842967846820498`*^9, 3.784296785870098*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  GraphicsBox[{{}, {{}, {}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.019444444444444445`], AbsoluteThickness[1.6], LineBox[CompressedData["

1:eJxTTMoPSmViYGAwBGIQDQEcB5IWympdtGJzgPDZD2zRu3pb1ZYVymc7IOzs
273angXKZz3wp9OyKsOJGcpnOXDgYAZriisTlM98gO/goafLPBihfKYDAYVP
m619GKB8xgMbVmw7GbPgnz3UAQfYbbWKZFf+gfL/7Tc7O8P03qZfUP6f/eIr
v8qe3fsDyv+1P19/+SnlU9+g/B/7P0Umumjf+ALlf9u/aYdtpuOLT1D+l/0t
l6MOPvj1Acr/tD9uzx6xCMV3UP6H/bc+Lg3+H/IKyn+zv4ErSV9y8jMo/8X+
j7NPZLDdfwTlP9l/6cUcvZTqe1D+g/0eMzdc+JpzHcq/sb9gx/G0+pUXoPwL
++c89l7+b+URKP/AfosvK06ULtkE8z8ULLCBytsroMhfsJ+Fov+GfTGK+Q/s
g1Hsf2J/AcV9L+w/obj/jX01iv8+2F9F8f8n+ySU8Pli34YSft/sN6CE7w/7
Lyjh/8u+HCV+/tgLo8TfP3sjlPhlcGBFiX9Gh3Uo6YPJATX9MDvwoKQvFgfU
9Mfq8BslfbI5iKOkX3aHnSjpm8MBlv4BFkj2xg==
       "]]}}, {}},
   AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
   Axes->{True, True},
   AxesLabel->{None, None},
   AxesOrigin->{0, 0},
   DisplayFunction->Identity,
   Frame->{{False, False}, {False, False}},
   FrameLabel->{{None, None}, {None, None}},
   FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
   GridLines->{None, None},
   GridLinesStyle->Directive[
     GrayLevel[0.5, 0.4]],
   ImageSize->{319.09090909091196`, Automatic},
   Method->{},
   PlotRange->{{-3., 3.}, {0, 2.778719262151001}},
   PlotRangeClipping->True,
   PlotRangePadding->{{
      Scaled[0.02], 
      Scaled[0.02]}, {
      Scaled[0.02], 
      Scaled[0.05]}},
   Ticks->{Automatic, Automatic}], " "}]], "Input",
 CellChangeTimes->{{3.784294865538287*^9, 3.7842948655702477`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, {}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.019444444444444445`],
      AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJxTTMoPSmViYGAwBGIQDQEcB5IWympdtGJzgPDZD2zRu3pb1ZYVymc7IOzs
273angXKZz3wp9OyKsOJGcpnOXDgYAZriisTlM98gO/goafLPBihfKYDAYVP
m619GKB8xgMbVmw7GbPgnz3UAQfYbbWKZFf+gfL/7Tc7O8P03qZfUP6f/eIr
v8qe3fsDyv+1P19/+SnlU9+g/B/7P0Umumjf+ALlf9u/aYdtpuOLT1D+l/0t
l6MOPvj1Acr/tD9uzx6xCMV3UP6H/bc+Lg3+H/IKyn+zv4ErSV9y8jMo/8X+
j7NPZLDdfwTlP9l/6cUcvZTqe1D+g/0eMzdc+JpzHcq/sb9gx/G0+pUXoPwL
++c89l7+b+URKP/AfosvK06ULtkE8z8ULLCBytsroMhfsJ+Fov+GfTGK+Q/s
g1Hsf2J/AcV9L+w/obj/jX01iv8+2F9F8f8n+ySU8Pli34YSft/sN6CE7w/7
Lyjh/8u+HCV+/tgLo8TfP3sjlPhlcGBFiX9Gh3Uo6YPJATX9MDvwoKQvFgfU
9Mfq8BslfbI5iKOkX3aHnSjpm8MBlv4BFkj2xg==
      "]]}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->{319.09090909091196`, Automatic},
  Method->{},
  PlotRange->{{-3., 3.}, {0, 2.778719262151001}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.784296369916953*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["overlap with asymptotic wavefunctions", "Subsubsection",
 CellChangeTimes->{{3.669357679614609*^9, 
  3.669357686083809*^9}},ExpressionUUID->"d78ef12d-dbef-4381-8f9f-\
3e0c9ec7ad90"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"bmax", "=", "3"}], ",", 
     RowBox[{"db", "=", 
      RowBox[{"1", "/", "8"}]}], ",", 
     RowBox[{"m", "=", "2"}]}], "}"}], ",", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"b", ",", 
           SuperscriptBox[
            RowBox[{"Abs", "[", 
             RowBox[{"gsminusinf", ".", 
              RowBox[{
               RowBox[{"gs", "[", 
                RowBox[{"b", ",", "m"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "]"}], "2"]}], "}"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", 
           SuperscriptBox[
            RowBox[{"Abs", "[", 
             RowBox[{"gsplusinf", ".", 
              RowBox[{
               RowBox[{"gs", "[", 
                RowBox[{"b", ",", "m"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "]"}], "2"]}], "}"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", 
           SuperscriptBox[
            RowBox[{"Abs", "[", 
             RowBox[{
              FractionBox[
               RowBox[{"gs0up", "-", "gs0dn"}], 
               SqrtBox["2"]], ".", 
              RowBox[{
               RowBox[{"gs", "[", 
                RowBox[{"b", ",", "m"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "]"}], "2"]}], "}"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", 
           SuperscriptBox[
            RowBox[{"Abs", "[", 
             RowBox[{
              FractionBox[
               RowBox[{"gs0up", "+", "gs0dn"}], 
               SqrtBox["2"]], ".", 
              RowBox[{
               RowBox[{"gs", "[", 
                RowBox[{"b", ",", "m"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "]"}], "2"]}], "}"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"Abs", "[", 
              RowBox[{
               FractionBox[
                RowBox[{"gs0up", "-", "gs0dn"}], 
                SqrtBox["2"]], ".", 
               RowBox[{
                RowBox[{"gs", "[", 
                 RowBox[{"b", ",", "m"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"Abs", "[", 
              RowBox[{
               FractionBox[
                RowBox[{"gs0up", "+", "gs0dn"}], 
                SqrtBox["2"]], ".", 
               RowBox[{
                RowBox[{"gs", "[", 
                 RowBox[{"b", ",", "m"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "]"}], "2"]}]}], 
          "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", 
         RowBox[{"-", "bmax"}], ",", "bmax", ",", "db"}], "}"}]}], "]"}], "//",
      "Transpose"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.66935769728001*^9, 3.669357718091044*^9}, {
  3.6693592504595823`*^9, 3.6693592916555147`*^9}, {3.6693745255488997`*^9, 
  3.669374539590768*^9}, {3.7324299311830387`*^9, 3.732429964449891*^9}},
 ExpressionUUID -> "35821623-f22b-4b81-903c-ec123c0c0f13"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partd"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part specification \[NoBreak]\\!\\(\\(\\(gs[\\(\\(\\(\\(-3\
\\)\\), 2\\)\\)]\\)\\) \[LeftDoubleBracket] \\(\\(2, 1\\)\\) \
\[RightDoubleBracket]\\)\[NoBreak] is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.7842932893505573`*^9, 3.7842937200138144`*^9, 
  3.7842941033089356`*^9, 3.784294286030954*^9, 3.7842944607699556`*^9, 
  3.784294564443535*^9, 3.7842946114806414`*^9, 3.7842963699767585`*^9, 
  3.7842965805100393`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partd"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part specification \[NoBreak]\\!\\(\\(\\(gs[\\(\\(\\(\\(-3\
\\)\\), 2\\)\\)]\\)\\) \[LeftDoubleBracket] \\(\\(2, 1\\)\\) \
\[RightDoubleBracket]\\)\[NoBreak] is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.7842932893505573`*^9, 3.7842937200138144`*^9, 
  3.7842941033089356`*^9, 3.784294286030954*^9, 3.7842944607699556`*^9, 
  3.784294564443535*^9, 3.7842946114806414`*^9, 3.7842963699767585`*^9, 
  3.7842965805459433`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partd"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part specification \[NoBreak]\\!\\(\\(\\(gs[\\(\\(\\(\\(-3\
\\)\\), 2\\)\\)]\\)\\) \[LeftDoubleBracket] \\(\\(2, 1\\)\\) \
\[RightDoubleBracket]\\)\[NoBreak] is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.7842932893505573`*^9, 3.7842937200138144`*^9, 
  3.7842941033089356`*^9, 3.784294286030954*^9, 3.7842944607699556`*^9, 
  3.784294564443535*^9, 3.7842946114806414`*^9, 3.7842963699767585`*^9, 
  3.78429658056589*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Part :: \
partd\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.7842932893505573`*^9, 3.7842937200138144`*^9, 
  3.7842941033089356`*^9, 3.784294286030954*^9, 3.7842944607699556`*^9, 
  3.784294564443535*^9, 3.7842946114806414`*^9, 3.7842963699767585`*^9, 
  3.78429658058484*^9}],

Cell[BoxData[
 GraphicsBox[{{}, {}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotRange->{{0, 1}, {0, 1}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.783605216552059*^9, 3.78429329059124*^9, 
  3.7842937229933977`*^9, 3.7842941034794817`*^9, 3.784294286215464*^9, 
  3.7842944609548807`*^9, 3.7842945646270475`*^9, 3.78429461166415*^9, 
  3.7842963711705666`*^9, 3.7842965816211004`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["magnetization", "Subsubsection",
 CellChangeTimes->{{3.669357726944531*^9, 
  3.669357729103805*^9}},ExpressionUUID->"7d490f36-7138-41a7-928a-\
74304e1ddf4f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"bmax", "=", "3"}], ",", 
     RowBox[{"db", "=", 
      RowBox[{"1", "/", "8"}]}], ",", 
     RowBox[{"m", "=", "2"}]}], "}"}], ",", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"b", ",", 
           RowBox[{"mx", "[", 
            RowBox[{"b", ",", "m", ",", "1"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", 
           RowBox[{"mz", "[", 
            RowBox[{"b", ",", "m", ",", "1"}], "]"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", 
         RowBox[{"-", "bmax"}], ",", "bmax", ",", "db"}], "}"}]}], "]"}], "//",
      "Transpose"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.66935769728001*^9, 3.669357718091044*^9}, {
  3.669357828403386*^9, 3.669357856859311*^9}, {3.6693592971800327`*^9, 
  3.669359297673254*^9}, {3.732429869914789*^9, 3.732429873351469*^9}, {
  3.732429941646681*^9, 3.732429959064794*^9}},
 ExpressionUUID -> "44c4a8b3-dbef-4b04-a184-8873435c925d"],

Cell[BoxData[
 GraphicsBox[{{}, {}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotRange->{{0, 1}, {0, 1}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.7836052170222807`*^9, 3.7842932906909733`*^9, 
  3.784293723122569*^9, 3.7842941035263634`*^9, 3.784294286248374*^9, 
  3.784294460990783*^9, 3.784294564882371*^9, 3.7842946117040443`*^9, 
  3.7842963713181725`*^9, 3.7842965816809406`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["correlations", "Subsubsection",
 CellChangeTimes->{{3.669357867658564*^9, 
  3.669357868907228*^9}},ExpressionUUID->"494b1a59-ebb2-44e3-94e6-\
d276e9c9b5f1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"bmax", "=", "3"}], ",", 
     RowBox[{"db", "=", 
      RowBox[{"1", "/", "8"}]}], ",", 
     RowBox[{"m", "=", "2"}]}], "}"}], ",", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"b", ",", 
         RowBox[{"c", "[", 
          RowBox[{"b", ",", "m", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"1", "+", "\[Delta]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Delta]", ",", "1", ",", "7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", 
         RowBox[{"-", "bmax"}], ",", "bmax", ",", "db"}], "}"}]}], "]"}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"Range", "[", "7", "]"}]}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.66935769728001*^9, 3.669357718091044*^9}, {
   3.669357828403386*^9, 3.669357856859311*^9}, 3.669357966935072*^9, {
   3.6693579974947987`*^9, 3.6693580852113333`*^9}, 3.669359028504243*^9, 
   3.6693593028931837`*^9, {3.732429882115901*^9, 3.73242988232614*^9}, {
   3.751394041055704*^9, 3.7513940497561903`*^9}},
 ExpressionUUID -> "ee238a47-281d-43f9-b0c5-d6515adbc9ca"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partd"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part specification \[NoBreak]\\!\\(\\(\\(gs[\\(\\(\\(\\(-3\
\\)\\), 2\\)\\)]\\)\\) \[LeftDoubleBracket] \\(\\(2, 1\\)\\) \
\[RightDoubleBracket]\\)\[NoBreak] is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.784293290751809*^9, 3.784293723212891*^9, 
  3.7842941035802107`*^9, 3.7842942862962465`*^9, 3.784294461038658*^9, 
  3.7842945649481754`*^9, 3.7842946117529135`*^9, 3.784296371368038*^9, 
  3.784296581741749*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partd"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part specification \
\[NoBreak]\\!\\(\\(\\(gs[\\(\\(\\(\\(-\\(\\(23\\/8\\)\\)\\)\\), \
2\\)\\)]\\)\\) \[LeftDoubleBracket] \\(\\(2, 1\\)\\) \[RightDoubleBracket]\\)\
\[NoBreak] is longer than depth of object. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partd\\\", ButtonNote -> \
\\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.784293290751809*^9, 3.784293723212891*^9, 
  3.7842941035802107`*^9, 3.7842942862962465`*^9, 3.784294461038658*^9, 
  3.7842945649481754`*^9, 3.7842946117529135`*^9, 3.784296371368038*^9, 
  3.7842965817926455`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partd"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part specification \
\[NoBreak]\\!\\(\\(\\(gs[\\(\\(\\(\\(-\\(\\(11\\/4\\)\\)\\)\\), \
2\\)\\)]\\)\\) \[LeftDoubleBracket] \\(\\(2, 1\\)\\) \[RightDoubleBracket]\\)\
\[NoBreak] is longer than depth of object. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partd\\\", ButtonNote -> \
\\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.784293290751809*^9, 3.784293723212891*^9, 
  3.7842941035802107`*^9, 3.7842942862962465`*^9, 3.784294461038658*^9, 
  3.7842945649481754`*^9, 3.7842946117529135`*^9, 3.784296371368038*^9, 
  3.7842965818235273`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Part :: \
partd\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.784293290751809*^9, 3.784293723212891*^9, 
  3.7842941035802107`*^9, 3.7842942862962465`*^9, 3.784294461038658*^9, 
  3.7842945649481754`*^9, 3.7842946117529135`*^9, 3.784296371368038*^9, 
  3.7842965818434896`*^9}],

Cell[BoxData[
 TemplateBox[{
  GraphicsBox[{{}, {}, {}}, {
    DisplayFunction -> Identity, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.02], 
        Scaled[0.05]}}, AxesOrigin -> {0, 0}, PlotRange -> {{0, 1}, {0, 1}}, 
     DisplayFunction -> Identity, AspectRatio -> 
     NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> {True, True}, 
     AxesLabel -> {None, None}, AxesOrigin -> {0, 0}, DisplayFunction :> 
     Identity, Frame -> {{False, False}, {False, False}}, 
     FrameLabel -> {{None, None}, {None, None}}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], Method -> {}, PlotRange -> {{0, 1}, {0, 1}}, 
     PlotRangeClipping -> True, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.02], 
        Scaled[0.05]}}, Ticks -> {Automatic, Automatic}}],FormBox[
    FormBox[
     TemplateBox[{"1", "2", "3", "4", "5", "6", "7"}, "LineLegend", 
      DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.35], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.35], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.35], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.35], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #2}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.35], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.35], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #3}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.35], 
                    RGBColor[0.922526, 0.385626, 0.209179], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.35], 
                    RGBColor[0.922526, 0.385626, 0.209179], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #4}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.35], 
                    RGBColor[0.528488, 0.470624, 0.701351], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.35], 
                    RGBColor[0.528488, 0.470624, 0.701351], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #5}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.35], 
                    RGBColor[0.772079, 0.431554, 0.102387], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.35], 
                    RGBColor[0.772079, 0.431554, 0.102387], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #6}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.35], 
                    RGBColor[0.363898, 0.618501, 0.782349], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.35], 
                    RGBColor[0.363898, 0.618501, 0.782349], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #7}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"LineLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.019444444444444445`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    RowBox[{
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> 
                    RGBColor[
                    0.24561133333333335`, 0.3378526666666667, 
                    0.4731986666666667], FrameTicks -> None, PlotRangePadding -> 
                    None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "\[InvisibleSpace]"}], 
                    "RGBColor[0.368417, 0.506779, 0.709798]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.368417, 0.506779, 0.709798]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.368417, 0.506779, 0.709798], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.019444444444444445`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    RowBox[{
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> 
                    RGBColor[
                    0.587148, 0.40736066666666665`, 0.09470066666666668], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "\[InvisibleSpace]"}], 
                    "RGBColor[0.880722, 0.611041, 0.142051]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.880722, 0.611041, 0.142051]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.880722, 0.611041, 0.142051], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.019444444444444445`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    RowBox[{
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> 
                    RGBColor[
                    0.37345400000000006`, 0.461046, 0.12992333333333334`], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "\[InvisibleSpace]"}], 
                    "RGBColor[0.560181, 0.691569, 0.194885]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.560181, 0.691569, 0.194885]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.560181, 0.691569, 0.194885], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.019444444444444445`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    RowBox[{
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.922526, 0.385626, 0.209179], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> 
                    RGBColor[
                    0.6150173333333333, 0.25708400000000003`, 
                    0.13945266666666667`], FrameTicks -> None, 
                    PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "\[InvisibleSpace]"}], 
                    "RGBColor[0.922526, 0.385626, 0.209179]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.922526, 0.385626, 0.209179]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.922526, 0.385626, 0.209179], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.019444444444444445`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    RowBox[{
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.528488, 0.470624, 0.701351], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> 
                    RGBColor[
                    0.3523253333333333, 0.3137493333333333, 
                    0.46756733333333333`], FrameTicks -> None, 
                    PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "\[InvisibleSpace]"}], 
                    "RGBColor[0.528488, 0.470624, 0.701351]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.528488, 0.470624, 0.701351]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.528488, 0.470624, 0.701351], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.019444444444444445`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    RowBox[{
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.772079, 0.431554, 0.102387], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> 
                    RGBColor[
                    0.5147193333333333, 0.28770266666666666`, 
                    0.06825800000000001], FrameTicks -> None, 
                    PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "\[InvisibleSpace]"}], 
                    "RGBColor[0.772079, 0.431554, 0.102387]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.772079, 0.431554, 0.102387]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.772079, 0.431554, 0.102387], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.019444444444444445`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    RowBox[{
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.363898, 0.618501, 0.782349], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> 
                    RGBColor[0.24259866666666668`, 0.412334, 0.521566], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "\[InvisibleSpace]"}], 
                    "RGBColor[0.363898, 0.618501, 0.782349]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.363898, 0.618501, 0.782349]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.363898, 0.618501, 0.782349], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}]}],
              "}"}], ",", 
           RowBox[{"{", 
             
             RowBox[{#, ",", #2, ",", #3, ",", #4, ",", #5, ",", #6, 
               ",", #7}], "}"}], ",", 
           RowBox[{"Joined", "\[Rule]", 
             RowBox[{"{", 
               
               RowBox[{
                "True", ",", "True", ",", "True", ",", "True", ",", "True", 
                 ",", "True", ",", "True"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}]}], "}"}]}]}], 
         "]"}]& ), Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{3.783605223793193*^9, 3.7842932973751073`*^9, 
  3.784293735672448*^9, 3.7842941038195724`*^9, 3.7842942865435853`*^9, 
  3.7842944613408732`*^9, 3.784294565619584*^9, 3.7842946120251865`*^9, 
  3.784296377022601*^9, 3.7842965868909817`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["reduced density matrices", "Subsubsection",
 CellChangeTimes->{{3.670213641815433*^9, 
  3.670213647057622*^9}},ExpressionUUID->"aedd9272-7dfd-4608-9e38-\
9862aab6b728"],

Cell["\<\
functions for calculating reduced density matrices: (see \
ReducedDensityMatrix.nb)\
\>", "Text",
 CellChangeTimes->{{3.6894924398122797`*^9, 3.689492442996561*^9}, {
  3.689500485090173*^9, 3.689500489297065*^9}, {3.6959541063976727`*^9, 
  3.695954120636278*^9}, {3.751391452461199*^9, 3.751391456728899*^9}, {
  3.7513943015525723`*^9, 
  3.751394303474518*^9}},ExpressionUUID->"3a43741f-aea5-4861-bde5-\
a7bb144b4f0e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rdm", "[", 
    RowBox[{
     RowBox[{"\[Psi]ABC_", "?", "VectorQ"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dA_Integer", "/;", 
        RowBox[{"dA", "\[GreaterEqual]", "1"}]}], ",", 
       RowBox[{"dB_Integer", "/;", 
        RowBox[{"dB", "\[GreaterEqual]", "1"}]}], ",", 
       RowBox[{"dC_Integer", "/;", 
        RowBox[{"dC", "\[GreaterEqual]", "1"}]}]}], "}"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"Length", "[", "\[Psi]ABC", "]"}], "\[Equal]", 
    RowBox[{"dA", " ", "dB", " ", "dC"}]}]}], ":=", "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"P", "=", 
      RowBox[{"ArrayReshape", "[", 
       RowBox[{"\[Psi]ABC", ",", 
        RowBox[{"{", 
         RowBox[{"dA", ",", "dB", ",", "dC"}], "}"}]}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"P", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], "]"}], ".", 
       RowBox[{"ConjugateTranspose", "[", "P", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "4"}], "}"}]}], "}"}]}], "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"traceout", "[", 
    RowBox[{
     RowBox[{"\[Psi]_", "?", "VectorQ"}], ",", 
     RowBox[{"d_Integer", "/;", 
      RowBox[{"d", "\[GreaterEqual]", "1"}]}]}], "]"}], "/;", 
   RowBox[{"Divisible", "[", 
    RowBox[{
     RowBox[{"Length", "[", "\[Psi]", "]"}], ",", "d"}], "]"}]}], ":=", 
  RowBox[{"rdm", "[", 
   RowBox[{"\[Psi]", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "d", ",", 
      FractionBox[
       RowBox[{"Length", "[", "\[Psi]", "]"}], "d"]}], "}"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"traceout", "[", 
    RowBox[{
     RowBox[{"\[Psi]_", "?", "VectorQ"}], ",", 
     RowBox[{"d_Integer", "/;", 
      RowBox[{"d", "\[LessEqual]", 
       RowBox[{"-", "1"}]}]}]}], "]"}], "/;", 
   RowBox[{"Divisible", "[", 
    RowBox[{
     RowBox[{"Length", "[", "\[Psi]", "]"}], ",", 
     RowBox[{"-", "d"}]}], "]"}]}], ":=", 
  RowBox[{"rdm", "[", 
   RowBox[{"\[Psi]", ",", 
    RowBox[{"{", 
     RowBox[{
      FractionBox[
       RowBox[{"Length", "[", "\[Psi]", "]"}], 
       RowBox[{"-", "d"}]], ",", 
      RowBox[{"-", "d"}], ",", "1"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6701570444688797`*^9, 3.670157120931857*^9}, {
   3.6845564082585087`*^9, 3.684556426359207*^9}, {3.68455646673715*^9, 
   3.6845564853994102`*^9}, 3.6845568001260843`*^9, {3.684556875273527*^9, 
   3.684556897343663*^9}, 3.68455709400632*^9, {3.684557563143552*^9, 
   3.684557572989278*^9}, {3.684557656162505*^9, 3.6845576678394823`*^9}, {
   3.6845577969904623`*^9, 3.684557802749567*^9}, {3.684564631260564*^9, 
   3.6845646358264847`*^9}, {3.684568281499481*^9, 3.684568285572178*^9}, 
   3.68457069918618*^9, {3.689491380969852*^9, 3.6894913811918497`*^9}, 
   3.751391527735135*^9, {3.751391871278573*^9, 3.751391877757517*^9}},
 ExpressionUUID -> "360d5e8a-77ad-45de-ac56-610e59136be1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["entropy of entanglement", "Subsubsection",
 CellChangeTimes->{{3.669358102591971*^9, 
  3.669358107001751*^9}},ExpressionUUID->"ccf037a0-7daa-412c-a8eb-\
0e18f2299ab6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"s", "[", 
    RowBox[{"0", "|", "0."}], "]"}], "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"s", "[", "x_", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "x"}], " ", 
    RowBox[{"Log", "[", 
     RowBox[{"2", ",", "x"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.669358131135551*^9, 3.669358189037682*^9}, {
   3.669372799405608*^9, 3.66937280139149*^9}, {3.682313518075964*^9, 
   3.6823135207195873`*^9}, 3.739291845008617*^9},
 ExpressionUUID -> "224c2dbc-bf01-4499-b456-53d5460e23a7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EE", "[", 
   RowBox[{
    RowBox[{"S_", "?", "SpinQ"}], ",", "\[Psi]_"}], "]"}], ":=", 
  RowBox[{"Total", "[", 
   RowBox[{"s", "/@", 
    RowBox[{"Re", "[", 
     RowBox[{"Eigenvalues", "[", 
      RowBox[{"traceout", "[", 
       RowBox[{"\[Psi]", ",", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"Length", "[", "\[Psi]", "]"}], 
          RowBox[{
           RowBox[{"2", "S"}], "+", "1"}]]}]}], "]"}], "]"}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.669358131135551*^9, 3.669358189037682*^9}, 
   3.669372799405608*^9, {3.669372851634207*^9, 3.669372887780774*^9}, {
   3.670213712679706*^9, 3.670213737530792*^9}, {3.6959550466599827`*^9, 
   3.6959550526143303`*^9}, {3.751391561813396*^9, 3.7513915660881233`*^9}, {
   3.751391883251954*^9, 3.751391888466118*^9}},
 ExpressionUUID -> "167102be-51a9-4df2-8e82-2bf87f214887"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"bmax", "=", "3"}], ",", 
     RowBox[{"db", "=", 
      RowBox[{"1", "/", "8"}]}], ",", 
     RowBox[{"m", "=", "2"}]}], "}"}], ",", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"b", ",", 
         RowBox[{"EE", "[", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{
            RowBox[{"gs", "[", 
             RowBox[{"b", ",", "m"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", 
         RowBox[{"-", "bmax"}], ",", "bmax", ",", "db"}], "}"}]}], "]"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6693582090298233`*^9, 3.669358212167675*^9}, {
   3.669358282300137*^9, 3.669358287148634*^9}, 3.669359318924899*^9},
 ExpressionUUID -> "bfbeffc5-291f-49e0-8fd8-6c72a490fd7f"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partd"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part specification \[NoBreak]\\!\\(\\(\\(gs[\\(\\(\\(\\(-3\
\\)\\), 2\\)\\)]\\)\\) \[LeftDoubleBracket] \\(\\(2, 1\\)\\) \
\[RightDoubleBracket]\\)\[NoBreak] is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.784293297678346*^9, 3.7842937359502296`*^9, 
  3.7842941039472313`*^9, 3.7842942866542883`*^9, 3.7842944614761252`*^9, 
  3.784294565985165*^9, 3.784294612234138*^9, 3.784296377211107*^9, 
  3.784296587231107*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partd"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part specification \
\[NoBreak]\\!\\(\\(\\(gs[\\(\\(\\(\\(-\\(\\(23\\/8\\)\\)\\)\\), \
2\\)\\)]\\)\\) \[LeftDoubleBracket] \\(\\(2, 1\\)\\) \[RightDoubleBracket]\\)\
\[NoBreak] is longer than depth of object. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partd\\\", ButtonNote -> \
\\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.784293297678346*^9, 3.7842937359502296`*^9, 
  3.7842941039472313`*^9, 3.7842942866542883`*^9, 3.7842944614761252`*^9, 
  3.784294565985165*^9, 3.784294612234138*^9, 3.784296377211107*^9, 
  3.7842965872590227`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partd"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part specification \
\[NoBreak]\\!\\(\\(\\(gs[\\(\\(\\(\\(-\\(\\(11\\/4\\)\\)\\)\\), \
2\\)\\)]\\)\\) \[LeftDoubleBracket] \\(\\(2, 1\\)\\) \[RightDoubleBracket]\\)\
\[NoBreak] is longer than depth of object. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partd\\\", ButtonNote -> \
\\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.784293297678346*^9, 3.7842937359502296`*^9, 
  3.7842941039472313`*^9, 3.7842942866542883`*^9, 3.7842944614761252`*^9, 
  3.784294565985165*^9, 3.784294612234138*^9, 3.784296377211107*^9, 
  3.7842965872949066`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Part :: \
partd\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.784293297678346*^9, 3.7842937359502296`*^9, 
  3.7842941039472313`*^9, 3.7842942866542883`*^9, 3.7842944614761252`*^9, 
  3.784294565985165*^9, 3.784294612234138*^9, 3.784296377211107*^9, 
  3.7842965873437724`*^9}],

Cell[BoxData[
 GraphicsBox[{{}, {}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotRange->{{0, 1}, {0, 1}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {0, 0}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.783605224040386*^9, 3.7842932977989745`*^9, 
  3.7842937362272515`*^9, 3.784294104097829*^9, 3.784294286808876*^9, 
  3.784294461619931*^9, 3.7842945661547604`*^9, 3.784294612395731*^9, 
  3.7842963774031363`*^9, 3.7842965873787103`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["\[LeftGuillemet]"], "Input",
 CellChangeTimes->{3.7842933497951765`*^9}],

Cell[BoxData["\[LeftGuillemet]"], "Output",
 CellChangeTimes->{3.7842937362555523`*^9, 3.784294104116778*^9, 
  3.7842942868268642`*^9, 3.7842944616338186`*^9, 3.7842945661726613`*^9, 
  3.7842946124096794`*^9, 3.7842963774270725`*^9, 3.7842965873896503`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1536, 781},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (July 1, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 638, 14, 30, "Text"],
Cell[1199, 36, 2609, 48, 45, "Text"],
Cell[3811, 86, 433, 10, 30, "Text"],
Cell[CellGroupData[{
Cell[4269, 100, 214, 4, 101, "Title"],
Cell[CellGroupData[{
Cell[4508, 108, 142, 1, 49, "Subsection"],
Cell[4653, 111, 3207, 105, 172, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7897, 221, 178, 3, 49, "Subsection"],
Cell[8078, 226, 664, 21, 30, "Text"],
Cell[8745, 249, 1279, 37, 55, "Input"],
Cell[10027, 288, 602, 18, 30, "Text"],
Cell[10632, 308, 1199, 33, 72, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11868, 346, 159, 3, 49, "Subsection"],
Cell[12030, 351, 315, 9, 30, "Text"],
Cell[12348, 362, 1050, 31, 57, "DisplayFormulaNumbered"],
Cell[13401, 395, 1379, 37, 31, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14817, 437, 171, 2, 49, "Subsection"],
Cell[14991, 441, 382, 13, 44, "Text"],
Cell[15376, 456, 828, 21, 52, "Input"],
Cell[16207, 479, 163, 3, 30, "Text"],
Cell[16373, 484, 1698, 58, 124, "Input"],
Cell[18074, 544, 161, 3, 30, "Text"],
Cell[18238, 549, 1352, 39, 92, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19627, 593, 175, 3, 49, "Subsection"],
Cell[19805, 598, 11263, 302, 556, "Input"],
Cell[31071, 902, 11608, 282, 532, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42716, 1189, 177, 2, 49, "Subsection"],
Cell[CellGroupData[{
Cell[42918, 1195, 160, 2, 39, "Subsubsection"],
Cell[43081, 1199, 1285, 34, 31, "Input"],
Cell[44369, 1235, 1586, 38, 92, InheritFromParent],
Cell[CellGroupData[{
Cell[45980, 1277, 1578, 38, 227, "Input"],
Cell[47561, 1317, 1510, 36, 225, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[49120, 1359, 188, 3, 39, "Subsubsection"],
Cell[CellGroupData[{
Cell[49333, 1366, 3491, 98, 175, "Input"],
Cell[52827, 1466, 765, 14, 23, "Message"],
Cell[53595, 1482, 765, 14, 23, "Message"],
Cell[54363, 1498, 762, 14, 23, "Message"],
Cell[55128, 1514, 724, 14, 21, "Message"],
Cell[55855, 1530, 916, 25, 243, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[56820, 1561, 164, 3, 39, "Subsubsection"],
Cell[CellGroupData[{
Cell[57009, 1568, 1159, 31, 31, "Input"],
Cell[58171, 1601, 918, 25, 243, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[59138, 1632, 163, 3, 39, "Subsubsection"],
Cell[CellGroupData[{
Cell[59326, 1639, 1282, 32, 31, "Input"],
Cell[60611, 1673, 759, 14, 23, "Message"],
Cell[61373, 1689, 780, 15, 47, "Message"],
Cell[62156, 1706, 780, 15, 47, "Message"],
Cell[62939, 1723, 723, 14, 21, "Message"],
Cell[63665, 1739, 28653, 583, 245, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[92367, 2328, 175, 3, 39, "Subsubsection"],
Cell[92545, 2333, 432, 9, 30, "Text"],
Cell[92980, 2344, 3207, 85, 162, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[96224, 2434, 174, 3, 39, "Subsubsection"],
Cell[96401, 2439, 572, 15, 52, "Input"],
Cell[96976, 2456, 899, 22, 55, "Input"],
Cell[CellGroupData[{
Cell[97900, 2482, 1111, 31, 31, "Input"],
Cell[99014, 2515, 759, 14, 23, "Message"],
Cell[99776, 2531, 780, 15, 47, "Message"],
Cell[100559, 2548, 780, 15, 47, "Message"],
Cell[101342, 2565, 723, 14, 21, "Message"],
Cell[102068, 2581, 882, 23, 253, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[102987, 2609, 86, 1, 31, "Input"],
Cell[103076, 2612, 259, 3, 31, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

